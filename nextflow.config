/*******************************************************************************
********************** Config File for PhyloMagnet *****************************
*******************************************************************************/
params {
    project_list = ""
    is_runs = false
    fastq = ""

    megan_eggnog_map = "eggnog.map"
    reference_classes = "EggNOG.txt"

    // can be either "fasttree" or "iqtree-omp"
    phylo_method = "fasttree"
    // should be 1 by default?
    cpus = 30
    reference_dir = "references/"
    queries_dir = "queries/"
    taxonomy_level_trees = "order"
    lineage = "Rickettsiales"
    daa_meganizer = "/usr/local/megan/tools/daa-meganizer"
    gc_assembler = "/usr/local/megan/tools/gc-assembler"
    python3 = "/usr/bin/python3"
}

docker {
    remove = true
    fixOwnership = true
}

singularity {
    enabled = true
    autoMounts = true
}

executor {
    queueSize = 30
    memory = '120 GB'
}

process {
    cache = 'deep'

    $alignFastQFiles {
        memory = '50 GB'
        cpus = params.cpus
        maxForks = 1
    }
    $meganizeDAAFiles {
        memory = '20 GB'
        cpus = params.cpus / 4
        maxForks = 4
    }
    $geneCentricAssembly {
        memory = '20 GB'
        cpus = params.cpus / 4
        maxForks = 4
    }
    $buildTreeFromAlignment {
        memory = '5 GB'
        cpus = { task.attempt == 1 ? params.cpus / 10 : 1 }
        maxForks = 10
        errorStrategy = 'retry'
        maxRetries = 3
    }
    $alignContigs {
        memory = '30 GB'
        cpus = params.cpus / 4
        maxForks = 4
        errorStrategy = 'retry'
        maxRetries = 3
    }
}
